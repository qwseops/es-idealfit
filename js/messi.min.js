function Messi(t,s){var i,e=this;(e.options=jQuery.extend({},Messi.prototype.options,s||{}),e.messi=jQuery(e.template),e.setContent(t),null==e.options.title)?jQuery(".messi-titlebox",e.messi).remove():(jQuery(".messi-title",e.messi).append(e.options.title),0!==e.options.buttons.length||e.options.autoclose||e.options.closeButton&&((i=jQuery('<span class="messi-closebtn"></span>')).bind("click",(function(){e.hide()})),jQuery(".messi-titlebox",this.messi).prepend(i)),null!=e.options.titleClass&&jQuery(".messi-titlebox",this.messi).addClass(e.options.titleClass));if(null!=e.options.width&&jQuery(".messi-box",e.messi).css("width",e.options.width),e.options.buttons.length>0)for(var o=0;o<e.options.buttons.length;o++){var n=e.options.buttons[o].btnClass?e.options.buttons[o].btnClass:"",l=e.options.buttons[o].val?e.options.buttons[o].val:"",a=jQuery('<div class="btnbox"><button class="btn '+n+'" href="#">'+e.options.buttons[o].label+"</button></div>").data("value",l);a.bind("click",(function(){var t=jQuery.data(this,"value"),s=null!=e.options.callback?function(){e.options.callback(t)}:null;e.hide(s)})),jQuery(".messi-actions",this.messi).append(a)}else jQuery(".messi-footbox",this.messi).remove();return 0!==e.options.buttons.length||null!=e.options.title||e.options.autoclose||e.options.closeButton&&((i=jQuery('<span class="messi-closebtn"></span>')).bind("click",(function(){e.hide()})),jQuery(".messi-content",this.messi).prepend(i)),e.modal=e.options.modal?jQuery('<div class="messi-modal"></div>').css({opacity:e.options.modalOpacity,width:jQuery(document).width(),height:jQuery(document).height(),"z-index":e.options.zIndex+jQuery(".messi").length}).appendTo(document.body):null,e.options.show&&e.show(),jQuery(window).bind("resize",(function(){e.resize()})),null!=e.options.autoclose&&setTimeout((function(t){t.hide()}),e.options.autoclose,this),e}Messi.prototype={options:{autoclose:null,buttons:[],callback:null,center:!0,closeButton:!0,height:"auto",title:null,titleClass:null,modal:!1,modalOpacity:.2,padding:"10px",show:!0,unload:!0,viewport:{top:"0px",left:"0px"},width:"500px",zIndex:99999},template:'<div class="messi"><div class="messi-box"><div class="messi-wrapper"><div class="messi-titlebox"><span class="messi-title"></span></div><div class="messi-content"></div><div class="messi-footbox"><div class="messi-actions"></div></div></div></div></div>',content:"<div></div>",visible:!1,setContent:function(t){jQuery(".messi-content",this.messi).css({padding:this.options.padding,height:this.options.height}).empty().append(t)},viewport:function(){return{top:(jQuery(window).height()-this.messi.height())/2+jQuery(window).scrollTop()+"px",left:(jQuery(window).width()-this.messi.width())/2+jQuery(window).scrollLeft()+"px"}},show:function(){this.visible||(this.options.modal&&null!=this.modal&&this.modal.show(),this.messi.appendTo(document.body),this.options.center&&(this.options.viewport=this.viewport(jQuery(".messi-box",this.messi))),this.messi.css({top:this.options.viewport.top,left:this.options.viewport.left,"z-index":this.options.zIndex+jQuery(".messi").length}).show().animate({opacity:1},300),this.visible=!0)},hide:function(t){if(this.visible){var s=this;return this.messi.animate({opacity:0},300,(function(){s.options.modal&&null!=s.modal&&s.modal.remove(),s.messi.css({display:"none"}).remove(),s.visible=!1,t&&t.call(),s.options.unload&&s.unload()})),this}},resize:function(){this.options.modal&&jQuery(".messi-modal").css({width:jQuery(document).width(),height:jQuery(document).height()}),this.options.center&&(this.options.viewport=this.viewport(jQuery(".messi-box",this.messi)),this.messi.css({top:this.options.viewport.top,left:this.options.viewport.left}))},toggle:function(){return this[this.visible?"hide":"show"](),this},unload:function(){this.visible&&this.hide(),jQuery(window).unbind("resize",this.resize()),this.messi.remove()}},jQuery.extend(Messi,{alert:function(t,s,i){var e=[{id:"ok",label:i.btnText?i.btnText:"OK"}];return new Messi(t,i=jQuery.extend({closeButton:!1,modal:!0,buttons:e,callback:function(){}},i||{},{show:!0,unload:!0,callback:s}))},ask:function(t,s,i){var e=[{id:"yes",label:i.btnYesText?i.btnYesText:"Yes",val:"Y",btnClass:"btn-success"},{id:"no",label:i.btnNoText?i.btnNoText:"No",val:"N",btnClass:"btn-danger"}];return new Messi(t,i=jQuery.extend({closeButton:!1,modal:!0,buttons:e,callback:function(){}},i||{},{show:!0,unload:!0,callback:s}))},img:function(t,s){var i=new Image;jQuery(i).load((function(){var t=jQuery(window).width()-50,e=jQuery(window).height()-50,o=this.width>t||this.height>e?Math.min(t/this.width,e/this.height):1;jQuery(i).css({width:this.width*o,height:this.height*o}),s=jQuery.extend(s||{},{show:!0,unload:!0,closeButton:!0,width:this.width*o,height:this.height*o,padding:0}),new Messi(i,s)})).error((function(){console.log("Error loading "+t)})).attr("src",t)},load:function(t,s){s=jQuery.extend(s||{},{show:!0,unload:!0});var i={url:t,dataType:"html",cache:!1,error:function(t,s,i){console.log(t.responseText)},success:function(t){new Messi(t,s)}};jQuery.ajax(i)}});